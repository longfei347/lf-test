<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<script src=""></script>
</head>

<body>
</body>
<script type="text/javascript">
$(document).ready(function() {
	//组装flexgrid插件
	$("#flex").flexigrid({
		url: "${pageContext.request.contextPath}/rpt/bd/hospitalst.do",
		dataType: "json",
		colModel: [{
				display: '诊所名称',
				name: 'name',
				width: 130,
				sortable: false,
				align: 'center'
			},

			{
				display: '诊所类别',
				name: 'type',
				width: 130,
				sortable: false,
				align: 'center'
			},

			{
				display: '诊所评级',
				name: 'grade',
				width: 130,
				sortable: false,
				align: 'center'
			}, {
				display: '联系电话',
				name: 'tel',
				width: 130,
				sortable: false,
				align: 'center'
			}, {
				display: '城市',
				name: 'city',
				width: 130,
				sortable: false,
				align: 'center'
			}, {
				display: '地区',
				name: 'district',
				width: 130,
				sortable: false,
				align: 'center'
			}, {
				display: '详细地址',
				name: 'loc',
				width: 130,
				sortable: false,
				align: 'center'
			}, {
				display: '数据来源地址',
				name: 'url',
				width: 130,
				sortable: false,
				align: 'center'
			}

		],
		buttons: [{
			name: '导出Excel文件',
			id: 'export',
			bclass: 'edit',
			onpress: exportExcel
		}, {
			separator: true
		}],
		sortname: "id",
		sortorder: "DESC",
		usepager: true,
		title: '诊所清单',
		useRp: true,
		checkbox: 'none',
		query: $.toJSON($("#searchForm").formToArray()),
		rowId: 'id',
		rp: 20,
		showTableToggleBtn: false,
		autoload: false,
		height: 200,
		width: '100%'
	});

	//点击查询按钮
	$("#query").click(function() {

		//重置flexigrid插件的参数
		$('#flex').flexOptions({
			newp: 1
		});
		$('#flex').queryWithFrom($('#searchForm'));
	});
});

//导出Excel
function exportExcel(elementId, id) {
	var name = $("#s_name").val();
	var type = $("#s_type").val();
	var loc = $("#s_loc").val();
	var grade = $("#s_grade").val();


	var url = "${pageContext.request.contextPath}/rpt/bd/hospital/exportExcel.do";
	url += "?s_name=" + name + "&s_type=" + type + "&s_loc=" + loc + "&s_grade=" + grade;

	goTo(url);

}
</script>

</html>
