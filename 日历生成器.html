<html>

<head>
	<meta charset="utf-8">
	<title>日历生成器</title>
</head>
<script>
//===返回某月天数
function get_days_in_mongh(the_year, the_month) {
	//使用下月0日创建Date对象
	var the_prev_date = new Date(the_year, the_month, 0);
	//返回Date对象的日期,即为对应月份的最后一天
	return the_prev_date.getDate();
}

//===获取指定月份日历信息,并将该信息保存为二维数组并返回
function make_calendar(the_year, the_month) {
	var my_month = Array(7),
		days = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
	/*my_month.forEach((item,index)=> {
		item.length=7,item[0]=days[index],console.log(item)
	})*/
	my_month[0] = new Array(7);
	my_month[1] = new Array(7);
	my_month[2] = new Array(7);
	my_month[3] = new Array(7);
	my_month[4] = new Array(7);
	my_month[5] = new Array(7);
	my_month[6] = new Array(7);

	var calendar_date = new Date(the_year, the_month - 1, 1);
	var first_day = calendar_date.getDay(); //确定1号为星期几
	var days_in_month = get_days_in_mongh(the_year, the_month);
	var the_date = 1;
	var i, c, r; //r为表格中行号,c为表格中列号

	//===my_month[0]为表格标题行,第0行
	my_month[0] = days;
	/*my_month[0][0] = "Sun";
	my_month[0][1] = "Mon";
	my_month[0][2] = "Tue";
	my_month[0][3] = "Wed";
	my_month[0][4] = "Thu";
	my_month[0][5] = "Fri";
	my_month[0][6] = "Sat";*/
	//===第1行日期
	for (c = first_day; c < 7; c++) {
		my_month[1][c] = the_date;
		the_date++;
	}

	//===其他行日期
	for (r = 2; r < 7; r++) {
		for (c = 0; c < 7; c++) {
			if (the_date <= days_in_month) {
				my_month[r][c] = the_date;
				the_date++;
			}
		}
	}
	return my_month;
}

//===绘制日历
function draw_calendar(the_year, the_month) {
	var r = 0,
		c = 0;
	var my_month;
	var rowid = "",strTable=''; //为单元格指定根据行、列号确定的id，使其可以访问
	my_month = make_calendar(the_year, the_month);

	//===绘制表格
	strTable += "<table border='0'><tr>"
		//===绘制标题行,写入标题行
	for (r = 0; r < 7; r++) {
		strTable += "<td align='center' " + " style='font-size:12px;font-weight:bold'>" + my_month[0][r] + "</td>";
	}
	strTable += "</tr>"

	//===绘制其他行日期
	for (r = 1; r < 7; r++) {
		strTable += "<tr>"
		for (c = 0; c < 7; c++) {
			rowid = "td" + r + c; //由行、列编号确定单元格id，供后面使用

			strTable += "<td id=" + rowid + " align=center width=30 height=30'>";
			//===判断该单元格对应数据是否有内容
			if (my_month[r][c] > 0) {
				strTable += "<font style='cursor:hand;" + "font-size:13px;font-weight:bold'>" + my_month[r][c] + "</font>";
			} else {
				strTable += "<font style='cursor:hand;" + "font-size:13px;font-weight:bold'>" + "&nbsp;</font>";
			}
			strTable += "</td>"
		}
		strTable += "</tr>";
	}
	strTable += "</table>"
	return document.write(strTable)
}

//===更新日历
function update_calendar(the_year, the_month) {
	var r, c;
	var rowid = "";
	my_month = make_calendar(the_year, the_month);

	for (r = 1; r < 7; r++) {
		for (c = 0; c < 7; c++) {
			//通过行、列编号生成单元格id属发生值
			rowid = "td" + r + c;
			if (my_month[r][c] > 0) {
				document.getElementById(rowid).firstChild.innerHTML = my_month[r][c];
			} else {
				document.getElementById(rowid).firstChild.innerHTML = "";
			}
		}
	}
}
</script>

<body leftmargin="60px">
	<form name="form_calendar">
		<table border="1">
			<tr>
				<td>
					<select name="selected_month" onchange='update_calendar(form_calendar.selected_year.value, form_calendar.selected_month.value)' style="width:120">
						<option value="1">January</option>
						<option value="2">February</option>
						<option value="3">March</option>
						<option value="4">April</option>
						<option value="5">May</option>
						<option value="6">June</option>
						<option value="7">July</option>
						<option value="8">August</option>
						<option value="9">September</option>
						<option value="10">October</option>
						<option value="11">November</option>
						<option value="12">December</option>
					</select>
					&nbsp;
					<select name="selected_year" onchange='update_calendar(form_calendar.selected_year.value, form_calendar.selected_month.value)' style="width:120">
						<option value="2007">2007</option>
						<option value="2008">2008</option>
						<option value="2009">2009</option>
						<option value="2010">2010</option>
						<option value="2011">2011</option>
						<option value="2012">2012</option>
						<option value="2013">2013</option>
						<option value="2014">2014</option>
						<option value="2015">2015</option>
						<option value="2016">2016</option>
						<option value="2017">2017</option>
						<option value="2018">2018</option>
					</select>
				</td>
			</tr>
			<tr>
				<script>
				var current_date = new Date();
				//在下拉列表中选择当前月份
				form_calendar.selected_month.options[current_date.getMonth()].selected = true;

				current_year = current_date.getFullYear();

				for (i = 0; i < form_calendar.selected_year.length; i++) {
					//在下拉列表中选择当前年份
					if (form_calendar.selected_year.options[i].value == current_year)
						form_calendar.selected_year.options[i].selected = true;
				}
				</script>
				<td>
					<script>
					draw_calendar(current_date.getFullYear(), current_date.getMonth() + 1);
					</script>
				</td>
			</tr>
		</table>
	</form>
</body>

</html>
